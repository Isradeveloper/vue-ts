var Vt=e=>{throw TypeError(e)};var at=(e,t,r)=>t.has(e)||Vt("Cannot "+r);var N=(e,t,r)=>(at(e,t,"read from private field"),r?r.call(e):t.get(e)),we=(e,t,r)=>t.has(e)?Vt("Cannot add the same private member more than once"):t instanceof WeakSet?t.add(e):t.set(e,r),Ee=(e,t,r,s)=>(at(e,t,"write to private field"),s?s.call(e,r):t.set(e,r),r),je=(e,t,r)=>(at(e,t,"access private method"),r);import{S as tr,x as rr,y as _t,z as nr,A as sr,B,C as Ke,D as ir,w as te,E as or,G as Rt,H as ar,I as lr,J as ur,q as Ge,f as Y,u as ee,K as x,L as cr,M as St,N as j,g as Ut,O as dr,P as fr,Q as vr,R as pr,T as mr,d as ft,c as ne,a as y,n as vt,U as He,V as pt,t as ue,o as se,_ as mt,W as hr,X as gr,Y as ze,Z as At,$ as yr,p as br,h as ke,a0 as Ie,F as Be,r as lt,a1 as Or,m as wt,s as Vr,v as _r}from"./index-IxZdlAz-.js";import{u as Sr,g as Ar,a as wr}from"./get-product-image.action-Cht4SqX-.js";var ce,de,q,ie,oe,We,dt,Mt,Er=(Mt=class extends tr{constructor(t,r){super();we(this,oe);we(this,ce);we(this,de);we(this,q);we(this,ie);Ee(this,ce,t),this.setOptions(r),this.bindMethods(),je(this,oe,We).call(this)}bindMethods(){this.mutate=this.mutate.bind(this),this.reset=this.reset.bind(this)}setOptions(t){var s;const r=this.options;this.options=N(this,ce).defaultMutationOptions(t),rr(this.options,r)||N(this,ce).getMutationCache().notify({type:"observerOptionsUpdated",mutation:N(this,q),observer:this}),r!=null&&r.mutationKey&&this.options.mutationKey&&_t(r.mutationKey)!==_t(this.options.mutationKey)?this.reset():((s=N(this,q))==null?void 0:s.state.status)==="pending"&&N(this,q).setOptions(this.options)}onUnsubscribe(){var t;this.hasListeners()||(t=N(this,q))==null||t.removeObserver(this)}onMutationUpdate(t){je(this,oe,We).call(this),je(this,oe,dt).call(this,t)}getCurrentResult(){return N(this,de)}reset(){var t;(t=N(this,q))==null||t.removeObserver(this),Ee(this,q,void 0),je(this,oe,We).call(this),je(this,oe,dt).call(this)}mutate(t,r){var s;return Ee(this,ie,r),(s=N(this,q))==null||s.removeObserver(this),Ee(this,q,N(this,ce).getMutationCache().build(N(this,ce),this.options)),N(this,q).addObserver(this),N(this,q).execute(t)}},ce=new WeakMap,de=new WeakMap,q=new WeakMap,ie=new WeakMap,oe=new WeakSet,We=function(){var r;const t=((r=N(this,q))==null?void 0:r.state)??nr();Ee(this,de,{...t,isPending:t.status==="pending",isSuccess:t.status==="success",isError:t.status==="error",isIdle:t.status==="idle",mutate:this.mutate,reset:this.reset})},dt=function(t){sr.batch(()=>{var r,s,a,o,f,h,u,c;if(N(this,ie)&&this.hasListeners()){const O=N(this,de).variables,S=N(this,de).context;(t==null?void 0:t.type)==="success"?((s=(r=N(this,ie)).onSuccess)==null||s.call(r,t.data,O,S),(o=(a=N(this,ie)).onSettled)==null||o.call(a,t.data,null,O,S)):(t==null?void 0:t.type)==="error"&&((h=(f=N(this,ie)).onError)==null||h.call(f,t.error,O,S),(c=(u=N(this,ie)).onSettled)==null||c.call(u,void 0,t.error,O,S))}this.listeners.forEach(O=>{O(N(this,de))})})},Mt);function jr(e,t){const r=Sr(),s=B(()=>r.defaultMutationOptions(ar(e))),a=new Er(r,s.value),o=Ke(a.getCurrentResult()),f=a.subscribe(c=>{ir(o,c)}),h=(c,O)=>{a.mutate(c,O).catch(()=>{})};te(s,()=>{a.setOptions(s.value)}),lr(()=>{f()});const u=or(Rt(o));return te(()=>o.error,c=>{if(c&&ur(s.value.throwOnError,[c]))throw c}),{...u,mutate:h,mutateAsync:o.mutate,reset:o.reset}}const Ir=async e=>{if(e==="create")return{id:"",title:"",slug:"",description:"",price:0,stock:0,images:[],tags:[],sizes:[],gender:"",user:{}};try{const{data:t}=await Ge.get(`/products/${e}`);return{...t,images:t.images.filter(r=>typeof r=="string").map(Ar)}}catch(t){throw console.log(t),new Error(`Error getting product by id ${e}`)}},Cr=async e=>{const t=e.id;e.images=await Tr(e.images??[]);const r=Pr(e);return t&&t!==""?await Nr(t,r):await Fr(r)},Pr=e=>{const t=(e.images||[]).filter(o=>typeof o=="string").map(o=>o.startsWith("http")?o.split("/").pop()?o:"":o),{id:r,user:s,...a}=e;return{...a,images:t}},Nr=async(e,t)=>{try{const{data:r}=await Ge.patch(`/products/${e}`,t);return r}catch(r){throw console.log(r),new Error("Error updating product")}},Fr=async e=>{try{const{data:t}=await Ge.post("/products",e);return t}catch(t){throw console.log(t),new Error("Error creating product")}},Tr=async e=>{const t=e.filter(o=>o instanceof File),r=e.filter(o=>typeof o=="string"),s=t.map(async o=>{try{const f=new FormData;f.append("file",o);const{data:h}=await Ge.post("/files/product",f);return h.secureUrl}catch(f){throw console.log(f),new Error("Ha ocurrido un error al cargar las imágenes")}}),a=await Promise.all(s);return[...r,...a]};/**
  * vee-validate v4.13.2
  * (c) 2024 Abdelrahman Awad
  * @license MIT
  */function Q(e){return typeof e=="function"}function Ce(e){return e==null}const Pe=e=>e!==null&&!!e&&typeof e=="object"&&!Array.isArray(e);function ht(e){return Number(e)>=0}function kr(e){return typeof e=="object"&&e!==null}function Mr(e){return e==null?e===void 0?"[object Undefined]":"[object Null]":Object.prototype.toString.call(e)}function Et(e){if(!kr(e)||Mr(e)!=="[object Object]")return!1;if(Object.getPrototypeOf(e)===null)return!0;let t=e;for(;Object.getPrototypeOf(t)!==null;)t=Object.getPrototypeOf(t);return Object.getPrototypeOf(e)===t}function Re(e,t){return Object.keys(t).forEach(r=>{if(Et(t[r])&&Et(e[r])){e[r]||(e[r]={}),Re(e[r],t[r]);return}e[r]=t[r]}),e}function De(e){const t=e.split(".");if(!t.length)return"";let r=String(t[0]);for(let s=1;s<t.length;s++){if(ht(t[s])){r+=`[${t[s]}]`;continue}r+=`.${t[s]}`}return r}const Rr={};function Ur(e){return Rr[e]}function jt(e,t,r){typeof r.value=="object"&&(r.value=w(r.value)),!r.enumerable||r.get||r.set||!r.configurable||!r.writable||t==="__proto__"?Object.defineProperty(e,t,r):e[t]=r.value}function w(e){if(typeof e!="object")return e;var t=0,r,s,a,o=Object.prototype.toString.call(e);if(o==="[object Object]"?a=Object.create(e.__proto__||null):o==="[object Array]"?a=Array(e.length):o==="[object Set]"?(a=new Set,e.forEach(function(f){a.add(w(f))})):o==="[object Map]"?(a=new Map,e.forEach(function(f,h){a.set(w(h),w(f))})):o==="[object Date]"?a=new Date(+e):o==="[object RegExp]"?a=new RegExp(e.source,e.flags):o==="[object DataView]"?a=new e.constructor(w(e.buffer)):o==="[object ArrayBuffer]"?a=e.slice(0):o.slice(-6)==="Array]"&&(a=new e.constructor(e)),a){for(s=Object.getOwnPropertySymbols(e);t<s.length;t++)jt(a,s[t],Object.getOwnPropertyDescriptor(e,s[t]));for(t=0,s=Object.getOwnPropertyNames(e);t<s.length;t++)Object.hasOwnProperty.call(a,r=s[t])&&a[r]===e[r]||jt(a,r,Object.getOwnPropertyDescriptor(e,r))}return a||e}const $t=Symbol("vee-validate-form"),$r=typeof window<"u";function zr(e){return Q(e)&&!!e.__locatorRef}function fe(e){return!!e&&Q(e.parse)&&e.__type==="VVTypedSchema"}function zt(e){return!!e&&Q(e.validate)}function Br(e){return e==="checkbox"||e==="radio"}function Dr(e){return Pe(e)||Array.isArray(e)}function Lr(e){return Array.isArray(e)?e.length===0:Pe(e)&&Object.keys(e).length===0}function Xe(e){return/^\[.+\]$/i.test(e)}function qr(e){return Bt(e)&&e.multiple}function Bt(e){return e.tagName==="SELECT"}function Wr(e){return Dt(e)&&e.target&&"submit"in e.target}function Dt(e){return e?!!(typeof Event<"u"&&Q(Event)&&e instanceof Event||e&&e.srcElement):!1}function ve(e,t){if(e===t)return!0;if(e&&t&&typeof e=="object"&&typeof t=="object"){if(e.constructor!==t.constructor)return!1;var r,s,a;if(Array.isArray(e)){if(r=e.length,r!=t.length)return!1;for(s=r;s--!==0;)if(!ve(e[s],t[s]))return!1;return!0}if(e instanceof Map&&t instanceof Map){if(e.size!==t.size)return!1;for(s of e.entries())if(!t.has(s[0]))return!1;for(s of e.entries())if(!ve(s[1],t.get(s[0])))return!1;return!0}if(It(e)&&It(t))return!(e.size!==t.size||e.name!==t.name||e.lastModified!==t.lastModified||e.type!==t.type);if(e instanceof Set&&t instanceof Set){if(e.size!==t.size)return!1;for(s of e.entries())if(!t.has(s[0]))return!1;return!0}if(ArrayBuffer.isView(e)&&ArrayBuffer.isView(t)){if(r=e.length,r!=t.length)return!1;for(s=r;s--!==0;)if(e[s]!==t[s])return!1;return!0}if(e.constructor===RegExp)return e.source===t.source&&e.flags===t.flags;if(e.valueOf!==Object.prototype.valueOf)return e.valueOf()===t.valueOf();if(e.toString!==Object.prototype.toString)return e.toString()===t.toString();for(a=Object.keys(e),r=a.length,s=r;s--!==0;){var o=a[s];if(!ve(e[o],t[o]))return!1}return!0}return e!==e&&t!==t}function It(e){return $r?e instanceof File:!1}function gt(e){return Xe(e)?e.replace(/\[|\]/gi,""):e}function M(e,t,r){return e?Xe(t)?e[gt(t)]:(t||"").split(/\.|\[(\d+)\]/).filter(Boolean).reduce((a,o)=>Dr(a)&&o in a?a[o]:r,e):r}function R(e,t,r){if(Xe(t)){e[gt(t)]=r;return}const s=t.split(/\.|\[(\d+)\]/).filter(Boolean);let a=e;for(let o=0;o<s.length;o++){if(o===s.length-1){a[s[o]]=r;return}(!(s[o]in a)||Ce(a[s[o]]))&&(a[s[o]]=ht(s[o+1])?[]:{}),a=a[s[o]]}}function ut(e,t){if(Array.isArray(e)&&ht(t)){e.splice(Number(t),1);return}Pe(e)&&delete e[t]}function Ct(e,t){if(Xe(t)){delete e[gt(t)];return}const r=t.split(/\.|\[(\d+)\]/).filter(Boolean);let s=e;for(let o=0;o<r.length;o++){if(o===r.length-1){ut(s,r[o]);break}if(!(r[o]in s)||Ce(s[r[o]]))break;s=s[r[o]]}const a=r.map((o,f)=>M(e,r.slice(0,f).join(".")));for(let o=a.length-1;o>=0;o--)if(Lr(a[o])){if(o===0){ut(e,r[0]);continue}ut(a[o-1],r[o-1])}}function X(e){return Object.keys(e)}function Kr(e,t=void 0){const r=mr();return(r==null?void 0:r.provides[e])||fr(e,t)}function Pt(e,t=0){let r=null,s=[];return function(...a){return r&&clearTimeout(r),r=setTimeout(()=>{const o=e(...a);s.forEach(f=>f(o)),s=[]},t),new Promise(o=>s.push(o))}}function Hr(e,t){let r;return async function(...a){const o=e(...a);r=o;const f=await o;return o!==r?f:(r=void 0,t(f,a))}}function Gr({get:e,set:t}){const r=Y(w(e()));return te(e,s=>{ve(s,r.value)||(r.value=w(s))},{deep:!0}),te(r,s=>{ve(s,e())||t(w(s))},{deep:!0}),r}function Nt(e){return Array.isArray(e)?e:e?[e]:[]}function Le(e,t){const r={};for(const s in e)t.includes(s)||(r[s]=e[s]);return r}function Xr(e){let t=null,r=[];return function(...s){const a=x(()=>{if(t!==a)return;const o=e(...s);r.forEach(f=>f(o)),r=[],t=null});return t=a,new Promise(o=>r.push(o))}}function ct(e){if(Lt(e))return e._value}function Lt(e){return"_value"in e}function Jr(e){return e.type==="number"||e.type==="range"?Number.isNaN(e.valueAsNumber)?e.value:e.valueAsNumber:e.value}function Ft(e){if(!Dt(e))return e;const t=e.target;if(Br(t.type)&&Lt(t))return ct(t);if(t.type==="file"&&t.files){const r=Array.from(t.files);return t.multiple?r:r[0]}if(qr(t))return Array.from(t.options).filter(r=>r.selected&&!r.disabled).map(ct);if(Bt(t)){const r=Array.from(t.options).find(s=>s.selected);return r?ct(r):t.value}return Jr(t)}function Yr(e){const t={};return Object.defineProperty(t,"_$$isNormalized",{value:!0,writable:!1,enumerable:!1,configurable:!1}),e?Pe(e)&&e._$$isNormalized?e:Pe(e)?Object.keys(e).reduce((r,s)=>{const a=Qr(e[s]);return e[s]!==!1&&(r[s]=Tt(a)),r},t):typeof e!="string"?t:e.split("|").reduce((r,s)=>{const a=Zr(s);return a.name&&(r[a.name]=Tt(a.params)),r},t):t}function Qr(e){return e===!0?[]:Array.isArray(e)||Pe(e)?e:[e]}function Tt(e){const t=r=>typeof r=="string"&&r[0]==="@"?xr(r.slice(1)):r;return Array.isArray(e)?e.map(t):e instanceof RegExp?[e]:Object.keys(e).reduce((r,s)=>(r[s]=t(e[s]),r),{})}const Zr=e=>{let t=[];const r=e.split(":")[0];return e.includes(":")&&(t=e.split(":").slice(1).join(":").split(",")),{name:r,params:t}};function xr(e){const t=r=>M(r,e)||r[e];return t.__locatorRef=e,t}const en={generateMessage:({field:e})=>`${e} is not valid.`,bails:!0,validateOnBlur:!0,validateOnChange:!0,validateOnInput:!1,validateOnModelUpdate:!0};let tn=Object.assign({},en);const Me=()=>tn;async function rn(e,t,r={}){const s=r==null?void 0:r.bails,a={name:(r==null?void 0:r.name)||"{field}",rules:t,label:r==null?void 0:r.label,bails:s??!0,formData:(r==null?void 0:r.values)||{}},o=await nn(a,e);return Object.assign(Object.assign({},o),{valid:!o.errors.length})}async function nn(e,t){const r=e.rules;if(fe(r)||zt(r))return on(t,Object.assign(Object.assign({},e),{rules:r}));if(Q(r)||Array.isArray(r)){const h={field:e.label||e.name,name:e.name,label:e.label,form:e.formData,value:t},u=Array.isArray(r)?r:[r],c=u.length,O=[];for(let S=0;S<c;S++){const F=u[S],I=await F(t,h);if(!(typeof I!="string"&&!Array.isArray(I)&&I)){if(Array.isArray(I))O.push(...I);else{const Z=typeof I=="string"?I:Wt(h);O.push(Z)}if(e.bails)return{errors:O}}}return{errors:O}}const s=Object.assign(Object.assign({},e),{rules:Yr(r)}),a=[],o=Object.keys(s.rules),f=o.length;for(let h=0;h<f;h++){const u=o[h],c=await an(s,t,{name:u,params:s.rules[u]});if(c.error&&(a.push(c.error),e.bails))return{errors:a}}return{errors:a}}function sn(e){return!!e&&e.name==="ValidationError"}function qt(e){return{__type:"VVTypedSchema",async parse(r,s){var a;try{return{output:await e.validate(r,{abortEarly:!1,context:(s==null?void 0:s.formData)||{}}),errors:[]}}catch(o){if(!sn(o))throw o;if(!(!((a=o.inner)===null||a===void 0)&&a.length)&&o.errors.length)return{errors:[{path:o.path,errors:o.errors}]};const f=o.inner.reduce((h,u)=>{const c=u.path||"";return h[c]||(h[c]={errors:[],path:c}),h[c].errors.push(...u.errors),h},{});return{errors:Object.values(f)}}}}}async function on(e,t){const s=await(fe(t.rules)?t.rules:qt(t.rules)).parse(e,{formData:t.formData}),a=[];for(const o of s.errors)o.errors.length&&a.push(...o.errors);return{value:s.value,errors:a}}async function an(e,t,r){const s=Ur(r.name);if(!s)throw new Error(`No such validator '${r.name}' exists.`);const a=ln(r.params,e.formData),o={field:e.label||e.name,name:e.name,label:e.label,value:t,form:e.formData,rule:Object.assign(Object.assign({},r),{params:a})},f=await s(t,a,o);return typeof f=="string"?{error:f}:{error:f?void 0:Wt(o)}}function Wt(e){const t=Me().generateMessage;return t?t(e):"Field is invalid"}function ln(e,t){const r=s=>zr(s)?s(t):s;return Array.isArray(e)?e.map(r):Object.keys(e).reduce((s,a)=>(s[a]=r(e[a]),s),{})}async function un(e,t){const s=await(fe(e)?e:qt(e)).parse(w(t)),a={},o={};for(const f of s.errors){const h=f.errors,u=(f.path||"").replace(/\["(\d+)"\]/g,(c,O)=>`[${O}]`);a[u]={valid:!h.length,errors:h},h.length&&(o[u]=h[0])}return{valid:!s.errors.length,results:a,errors:o,values:s.value,source:"schema"}}async function cn(e,t,r){const a=X(e).map(async c=>{var O,S,F;const I=(O=r==null?void 0:r.names)===null||O===void 0?void 0:O[c],H=await rn(M(t,c),e[c],{name:(I==null?void 0:I.name)||c,label:I==null?void 0:I.label,values:t,bails:(F=(S=r==null?void 0:r.bailsMap)===null||S===void 0?void 0:S[c])!==null&&F!==void 0?F:!0});return Object.assign(Object.assign({},H),{path:c})});let o=!0;const f=await Promise.all(a),h={},u={};for(const c of f)h[c.path]={valid:c.valid,errors:c.errors},c.valid||(o=!1,u[c.path]=c.errors[0]);return{valid:o,results:h,errors:u,source:"schema"}}let dn=0;const qe=["bails","fieldsCount","id","multiple","type","validate"];function Kt(e){const t=(e==null?void 0:e.initialValues)||{},r=Object.assign({},j(t)),s=ee(e==null?void 0:e.validationSchema);return s&&fe(s)&&Q(s.cast)?w(s.cast(r)||{}):w(r)}function fn(e){var t;const r=dn++;let s=0;const a=Y(!1),o=Y(!1),f=Y(0),h=[],u=Ke(Kt(e)),c=Y([]),O=Y({}),S=Y({}),F=Xr(()=>{S.value=c.value.reduce((i,n)=>(i[De(j(n.path))]=n,i),{})});function I(i,n){const l=U(i);if(!l){typeof i=="string"&&(O.value[De(i)]=Nt(n));return}if(typeof i=="string"){const d=De(i);O.value[d]&&delete O.value[d]}l.errors=Nt(n),l.valid=!l.errors.length}function H(i){X(i).forEach(n=>{I(n,i[n])})}e!=null&&e.initialErrors&&H(e.initialErrors);const Z=B(()=>{const i=c.value.reduce((n,l)=>(l.errors.length&&(n[l.path]=l.errors),n),{});return Object.assign(Object.assign({},O.value),i)}),pe=B(()=>X(Z.value).reduce((i,n)=>{const l=Z.value[n];return l!=null&&l.length&&(i[n]=l[0]),i},{})),ye=B(()=>c.value.reduce((i,n)=>(i[n.path]={name:n.path||"",label:n.label||""},i),{})),Ne=B(()=>c.value.reduce((i,n)=>{var l;return i[n.path]=(l=n.bails)!==null&&l!==void 0?l:!0,i},{})),be=Object.assign({},(e==null?void 0:e.initialErrors)||{}),Oe=(t=e==null?void 0:e.keepValuesOnUnmount)!==null&&t!==void 0?t:!1,{initialValues:v,originalInitialValues:p,setInitialValues:V}=pn(c,u,e),A=vn(c,u,p,pe),E=B(()=>c.value.reduce((i,n)=>{const l=M(u,n.path);return R(i,n.path,l),i},{})),_=e==null?void 0:e.validationSchema;function k(i,n){var l,d;const g=B(()=>M(v.value,j(i))),b=S.value[j(i)],m=(n==null?void 0:n.type)==="checkbox"||(n==null?void 0:n.type)==="radio";if(b&&m){b.multiple=!0;const G=s++;return Array.isArray(b.id)?b.id.push(G):b.id=[b.id,G],b.fieldsCount++,b.__flags.pendingUnmount[G]=!1,b}const P=B(()=>M(u,j(i))),T=j(i),$=he.findIndex(G=>G===T);$!==-1&&he.splice($,1);const C=B(()=>{var G,Te,nt,st;const it=j(_);if(fe(it))return(Te=(G=it.describe)===null||G===void 0?void 0:G.call(it,j(i)).required)!==null&&Te!==void 0?Te:!1;const ot=j(n==null?void 0:n.schema);return fe(ot)&&(st=(nt=ot.describe)===null||nt===void 0?void 0:nt.call(ot).required)!==null&&st!==void 0?st:!1}),z=s++,L=Ke({id:z,path:i,touched:!1,pending:!1,valid:!0,validated:!!(!((l=be[T])===null||l===void 0)&&l.length),required:C,initialValue:g,errors:vr([]),bails:(d=n==null?void 0:n.bails)!==null&&d!==void 0?d:!1,label:n==null?void 0:n.label,type:(n==null?void 0:n.type)||"default",value:P,multiple:!1,__flags:{pendingUnmount:{[z]:!1},pendingReset:!1},fieldsCount:1,validate:n==null?void 0:n.validate,dirty:B(()=>!ve(ee(P),ee(g)))});return c.value.push(L),S.value[T]=L,F(),pe.value[T]&&!be[T]&&x(()=>{ge(T,{mode:"silent"})}),St(i)&&te(i,G=>{F();const Te=w(P.value);S.value[G]=L,x(()=>{R(u,G,Te)})}),L}const J=Pt(Ot,5),Je=Pt(Ot,5),Ve=Hr(async i=>await(i==="silent"?J():Je()),(i,[n])=>{const l=X(re.errorBag.value),g=[...new Set([...X(i.results),...c.value.map(b=>b.path),...l])].sort().reduce((b,m)=>{var P;const T=m,$=U(T)||_e(T),C=((P=i.results[T])===null||P===void 0?void 0:P.errors)||[],z=j($==null?void 0:$.path)||T,L=mn({errors:C,valid:!C.length},b.results[z]);return b.results[z]=L,L.valid||(b.errors[z]=L.errors[0]),$&&O.value[z]&&delete O.value[z],$?($.valid=L.valid,n==="silent"||n==="validated-only"&&!$.validated||I($,L.errors),b):(I(z,C),b)},{valid:i.valid,results:{},errors:{},source:i.source});return i.values&&(g.values=i.values,g.source=i.source),X(g.results).forEach(b=>{var m;const P=U(b);P&&n!=="silent"&&(n==="validated-only"&&!P.validated||I(P,(m=g.results[b])===null||m===void 0?void 0:m.errors))}),g});function me(i){c.value.forEach(i)}function U(i){const n=typeof i=="string"?De(i):i;return typeof n=="string"?S.value[n]:n}function _e(i){return c.value.filter(l=>i.startsWith(l.path)).reduce((l,d)=>l?d.path.length>l.path.length?d:l:d,void 0)}let he=[],Se;function Ye(i){return he.push(i),Se||(Se=x(()=>{[...he].sort().reverse().forEach(l=>{Ct(u,l)}),he=[],Se=null})),Se}function Ue(i){return function(l,d){return function(b){return b instanceof Event&&(b.preventDefault(),b.stopPropagation()),me(m=>m.touched=!0),a.value=!0,f.value++,Ae().then(m=>{const P=w(u);if(m.valid&&typeof l=="function"){const T=w(E.value);let $=i?T:P;return m.values&&($=m.source==="schema"?m.values:Object.assign({},$,m.values)),l($,{evt:b,controlledValues:T,setErrors:H,setFieldError:I,setTouched:xe,setFieldTouched:$e,setValues:Qe,setFieldValue:le,resetForm:et,resetField:yt})}!m.valid&&typeof d=="function"&&d({values:P,evt:b,errors:m.errors,results:m.results})}).then(m=>(a.value=!1,m),m=>{throw a.value=!1,m})}}}const K=Ue(!1);K.withControlled=Ue(!0);function ae(i,n){const l=c.value.findIndex(g=>g.path===i&&(Array.isArray(g.id)?g.id.includes(n):g.id===n)),d=c.value[l];if(!(l===-1||!d)){if(x(()=>{ge(i,{mode:"silent",warn:!1})}),d.multiple&&d.fieldsCount&&d.fieldsCount--,Array.isArray(d.id)){const g=d.id.indexOf(n);g>=0&&d.id.splice(g,1),delete d.__flags.pendingUnmount[n]}(!d.multiple||d.fieldsCount<=0)&&(c.value.splice(l,1),bt(i),F(),delete S.value[i])}}function Fe(i){X(S.value).forEach(n=>{n.startsWith(i)&&delete S.value[n]}),c.value=c.value.filter(n=>!n.path.startsWith(i)),x(()=>{F()})}const re={formId:r,values:u,controlledValues:E,errorBag:Z,errors:pe,schema:_,submitCount:f,meta:A,isSubmitting:a,isValidating:o,fieldArrays:h,keepValuesOnUnmount:Oe,validateSchema:ee(_)?Ve:void 0,validate:Ae,setFieldError:I,validateField:ge,setFieldValue:le,setValues:Qe,setErrors:H,setFieldTouched:$e,setTouched:xe,resetForm:et,resetField:yt,handleSubmit:K,useFieldModel:Zt,defineInputBinds:xt,defineComponentBinds:er,defineField:rt,stageInitialValue:Yt,unsetInitialValue:bt,setFieldInitialValue:tt,createPathState:k,getPathState:U,unsetPathValue:Ye,removePathState:ae,initialValues:v,getAllPathStates:()=>c.value,destroyPath:Fe,isFieldTouched:Gt,isFieldDirty:Xt,isFieldValid:Jt};function le(i,n,l=!0){const d=w(n),g=typeof i=="string"?i:i.path;U(g)||k(g),R(u,g,d),l&&ge(g)}function Ht(i,n=!0){X(u).forEach(l=>{delete u[l]}),X(i).forEach(l=>{le(l,i[l],!1)}),n&&Ae()}function Qe(i,n=!0){Re(u,i),h.forEach(l=>l&&l.reset()),n&&Ae()}function Ze(i,n){const l=U(j(i))||k(i);return B({get(){return l.value},set(d){var g;const b=j(i);le(b,d,(g=j(n))!==null&&g!==void 0?g:!1)}})}function $e(i,n){const l=U(i);l&&(l.touched=n)}function Gt(i){const n=U(i);return n?n.touched:c.value.filter(l=>l.path.startsWith(i)).some(l=>l.touched)}function Xt(i){const n=U(i);return n?n.dirty:c.value.filter(l=>l.path.startsWith(i)).some(l=>l.dirty)}function Jt(i){const n=U(i);return n?n.valid:c.value.filter(l=>l.path.startsWith(i)).every(l=>l.valid)}function xe(i){if(typeof i=="boolean"){me(n=>{n.touched=i});return}X(i).forEach(n=>{$e(n,!!i[n])})}function yt(i,n){var l;const d=n&&"value"in n?n.value:M(v.value,i),g=U(i);g&&(g.__flags.pendingReset=!0),tt(i,w(d),!0),le(i,d,!1),$e(i,(l=n==null?void 0:n.touched)!==null&&l!==void 0?l:!1),I(i,(n==null?void 0:n.errors)||[]),x(()=>{g&&(g.__flags.pendingReset=!1)})}function et(i,n){let l=w(i!=null&&i.values?i.values:p.value);l=n!=null&&n.force?l:Re(p.value,l),l=fe(_)&&Q(_.cast)?_.cast(l):l,V(l,{force:n==null?void 0:n.force}),me(d=>{var g;d.__flags.pendingReset=!0,d.validated=!1,d.touched=((g=i==null?void 0:i.touched)===null||g===void 0?void 0:g[d.path])||!1,le(d.path,M(l,d.path),!1),I(d.path,void 0)}),n!=null&&n.force?Ht(l,!1):Qe(l,!1),H((i==null?void 0:i.errors)||{}),f.value=(i==null?void 0:i.submitCount)||0,x(()=>{Ae({mode:"silent"}),me(d=>{d.__flags.pendingReset=!1})})}async function Ae(i){const n=(i==null?void 0:i.mode)||"force";if(n==="force"&&me(m=>m.validated=!0),re.validateSchema)return re.validateSchema(n);o.value=!0;const l=await Promise.all(c.value.map(m=>m.validate?m.validate(i).then(P=>({key:m.path,valid:P.valid,errors:P.errors,value:P.value})):Promise.resolve({key:m.path,valid:!0,errors:[],value:void 0})));o.value=!1;const d={},g={},b={};for(const m of l)d[m.key]={valid:m.valid,errors:m.errors},m.value&&R(b,m.key,m.value),m.errors.length&&(g[m.key]=m.errors[0]);return{valid:l.every(m=>m.valid),results:d,errors:g,values:b,source:"fields"}}async function ge(i,n){var l;const d=U(i);if(d&&(n==null?void 0:n.mode)!=="silent"&&(d.validated=!0),_){const{results:g}=await Ve((n==null?void 0:n.mode)||"validated-only");return g[i]||{errors:[],valid:!0}}return d!=null&&d.validate?d.validate(n):(!d&&(l=n==null?void 0:n.warn),Promise.resolve({errors:[],valid:!0}))}function bt(i){Ct(v.value,i)}function Yt(i,n,l=!1){tt(i,n),R(u,i,n),l&&!(e!=null&&e.initialValues)&&R(p.value,i,w(n))}function tt(i,n,l=!1){R(v.value,i,w(n)),l&&R(p.value,i,w(n))}async function Ot(){const i=ee(_);if(!i)return{valid:!0,results:{},errors:{},source:"none"};o.value=!0;const n=zt(i)||fe(i)?await un(i,u):await cn(i,u,{names:ye.value,bailsMap:Ne.value});return o.value=!1,n}const Qt=K((i,{evt:n})=>{Wr(n)&&n.target.submit()});cr(()=>{if(e!=null&&e.initialErrors&&H(e.initialErrors),e!=null&&e.initialTouched&&xe(e.initialTouched),e!=null&&e.validateOnMount){Ae();return}re.validateSchema&&re.validateSchema("silent")}),St(_)&&te(_,()=>{var i;(i=re.validateSchema)===null||i===void 0||i.call(re,"validated-only")}),pr($t,re);function rt(i,n){const l=Q(n)||n==null?void 0:n.label,d=U(j(i))||k(i,{label:l}),g=()=>Q(n)?n(Le(d,qe)):n||{};function b(){var C;d.touched=!0,((C=g().validateOnBlur)!==null&&C!==void 0?C:Me().validateOnBlur)&&ge(d.path)}function m(){var C;((C=g().validateOnInput)!==null&&C!==void 0?C:Me().validateOnInput)&&x(()=>{ge(d.path)})}function P(){var C;((C=g().validateOnChange)!==null&&C!==void 0?C:Me().validateOnChange)&&x(()=>{ge(d.path)})}const T=B(()=>{const C={onChange:P,onInput:m,onBlur:b};return Q(n)?Object.assign(Object.assign({},C),n(Le(d,qe)).props||{}):n!=null&&n.props?Object.assign(Object.assign({},C),n.props(Le(d,qe))):C});return[Ze(i,()=>{var C,z,L;return(L=(C=g().validateOnModelUpdate)!==null&&C!==void 0?C:(z=Me())===null||z===void 0?void 0:z.validateOnModelUpdate)!==null&&L!==void 0?L:!0}),T]}function Zt(i){return Array.isArray(i)?i.map(n=>Ze(n,!0)):Ze(i)}function xt(i,n){const[l,d]=rt(i,n);function g(){d.value.onBlur()}function b(P){const T=Ft(P);le(j(i),T,!1),d.value.onInput()}function m(P){const T=Ft(P);le(j(i),T,!1),d.value.onChange()}return B(()=>Object.assign(Object.assign({},d.value),{onBlur:g,onInput:b,onChange:m,value:l.value}))}function er(i,n){const[l,d]=rt(i,n),g=U(j(i));function b(m){l.value=m}return B(()=>{const m=Q(n)?n(Le(g,qe)):n||{};return Object.assign({[m.model||"modelValue"]:l.value,[`onUpdate:${m.model||"modelValue"}`]:b},d.value)})}return Object.assign(Object.assign({},re),{values:Rt(u),handleReset:()=>et(),submitForm:Qt})}function vn(e,t,r,s){const a={touched:"some",pending:"some",valid:"every"},o=B(()=>!ve(t,ee(r)));function f(){const u=e.value;return X(a).reduce((c,O)=>{const S=a[O];return c[O]=u[S](F=>F[O]),c},{})}const h=Ke(f());return Ut(()=>{const u=f();h.touched=u.touched,h.valid=u.valid,h.pending=u.pending}),B(()=>Object.assign(Object.assign({initialValues:ee(r)},h),{valid:h.valid&&!X(s.value).length,dirty:o.value}))}function pn(e,t,r){const s=Kt(r),a=Y(s),o=Y(w(s));function f(h,u){u!=null&&u.force?(a.value=w(h),o.value=w(h)):(a.value=Re(w(a.value)||{},w(h)),o.value=Re(w(o.value)||{},w(h))),u!=null&&u.updateFields&&e.value.forEach(c=>{if(c.touched)return;const S=M(a.value,c.path);R(t,c.path,w(S))})}return{initialValues:a,originalInitialValues:o,setInitialValues:f}}function mn(e,t){return t?{valid:e.valid&&t.valid,errors:[...e.errors,...t.errors]}:e}function kt(e){const t=Kr($t,void 0),r=Y([]),s=()=>{},a={fields:r,remove:s,push:s,swap:s,insert:s,update:s,replace:s,prepend:s,move:s};if(!t||!ee(e))return a;const o=t.fieldArrays.find(v=>ee(v.path)===ee(e));if(o)return o;let f=0;function h(){return M(t==null?void 0:t.values,j(e),[])||[]}function u(){const v=h();Array.isArray(v)&&(r.value=v.map((p,V)=>O(p,V,r.value)),c())}u();function c(){const v=r.value.length;for(let p=0;p<v;p++){const V=r.value[p];V.isFirst=p===0,V.isLast=p===v-1}}function O(v,p,V){if(V&&!Ce(p)&&V[p])return V[p];const A=f++;return{key:A,value:Gr({get(){const _=M(t==null?void 0:t.values,j(e),[])||[],k=r.value.findIndex(J=>J.key===A);return k===-1?v:_[k]},set(_){const k=r.value.findIndex(J=>J.key===A);k!==-1&&ye(k,_)}}),isFirst:!1,isLast:!1}}function S(){c(),t==null||t.validate({mode:"silent"})}function F(v){const p=j(e),V=M(t==null?void 0:t.values,p);if(!V||!Array.isArray(V))return;const A=[...V];A.splice(v,1);const E=p+`[${v}]`;t.destroyPath(E),t.unsetInitialValue(E),R(t.values,p,A),r.value.splice(v,1),S()}function I(v){const p=w(v),V=j(e),A=M(t==null?void 0:t.values,V),E=Ce(A)?[]:A;if(!Array.isArray(E))return;const _=[...E];_.push(p),t.stageInitialValue(V+`[${_.length-1}]`,p),R(t.values,V,_),r.value.push(O(p)),S()}function H(v,p){const V=j(e),A=M(t==null?void 0:t.values,V);if(!Array.isArray(A)||!(v in A)||!(p in A))return;const E=[...A],_=[...r.value],k=E[v];E[v]=E[p],E[p]=k;const J=_[v];_[v]=_[p],_[p]=J,R(t.values,V,E),r.value=_,c()}function Z(v,p){const V=w(p),A=j(e),E=M(t==null?void 0:t.values,A);if(!Array.isArray(E)||E.length<v)return;const _=[...E],k=[...r.value];_.splice(v,0,V),k.splice(v,0,O(V)),R(t.values,A,_),r.value=k,S()}function pe(v){const p=j(e);t.stageInitialValue(p,v),R(t.values,p,v),u(),S()}function ye(v,p){const V=j(e),A=M(t==null?void 0:t.values,V);!Array.isArray(A)||A.length-1<v||(R(t.values,`${V}[${v}]`,p),t==null||t.validate({mode:"validated-only"}))}function Ne(v){const p=w(v),V=j(e),A=M(t==null?void 0:t.values,V),E=Ce(A)?[]:A;if(!Array.isArray(E))return;const _=[p,...E];R(t.values,V,_),t.stageInitialValue(V+"[0]",p),r.value.unshift(O(p)),S()}function be(v,p){const V=j(e),A=M(t==null?void 0:t.values,V),E=Ce(A)?[]:[...A];if(!Array.isArray(A)||!(v in A)||!(p in A))return;const _=[...r.value],k=_[v];_.splice(v,1),_.splice(p,0,k);const J=E[v];E.splice(v,1),E.splice(p,0,J),R(t.values,V,E),r.value=_,S()}const Oe={fields:r,remove:F,push:I,swap:H,insert:Z,update:ye,replace:pe,prepend:Ne,move:be};return t.fieldArrays.push(Object.assign({path:e,reset:u},Oe)),dr(()=>{const v=t.fieldArrays.findIndex(p=>j(p.path)===j(e));v>=0&&t.fieldArrays.splice(v,1)}),te(h,v=>{const p=r.value.map(V=>V.value);ve(v,p)||u()}),Oe}const hn=["type","value"],gn=ft({__name:"CustomInput",props:{modelValue:{},error:{},type:{default:"text"}},emits:["update:modelValue","blur"],setup(e){return(t,r)=>(se(),ne("div",null,[y("input",{type:t.type,value:t.modelValue,onInput:r[0]||(r[0]=s=>{var a;return t.$emit("update:modelValue",((a=s.target)==null?void 0:a.value)??"")}),onBlur:r[1]||(r[1]=s=>t.$emit("blur")),class:vt(["form-control",{"border-red-500":t.error}])},null,42,hn),He(y("span",{class:"text-red-400"},ue(t.error),513),[[pt,t.error]])]))}}),yn=mt(gn,[["__scopeId","data-v-017fda6d"]]),bn=["value"],On=ft({__name:"CustomTextArea",props:{modelValue:{},error:{}},emits:["update:modelValue","blur"],setup(e){return(t,r)=>(se(),ne("div",null,[y("textarea",{value:t.modelValue,onInput:r[0]||(r[0]=s=>{var a;return t.$emit("update:modelValue",((a=s.target)==null?void 0:a.value)??"")}),onBlur:r[1]||(r[1]=s=>t.$emit("blur")),class:vt(["form-control focus:shadow-outline",{"border-red-500":t.error}])},null,42,bn),He(y("span",{class:"text-red-400"},ue(t.error),513),[[pt,t.error]])]))}}),Vn=mt(On,[["__scopeId","data-v-b36c43c2"]]),_n=gr({title:ze().required("Este campo es super importante").min(2),slug:ze().required(),description:ze().required(),price:At().required(),stock:At().min(1).required(),gender:ze().required().oneOf(["men","women","kid"])}),Sn=ft({components:{CustomInput:yn,CustomTextArea:Vn},props:{productId:{type:String,required:!0}},setup(e){const t=yr(),r=hr(),{data:s,isError:a,isLoading:o,refetch:f}=wr({queryKey:["product",e.productId],queryFn:()=>Ir(e.productId),retry:!1}),{mutate:h,isPending:u,isSuccess:c,data:O}=jr({mutationFn:Cr}),{values:S,defineField:F,errors:I,handleSubmit:H,resetForm:Z,meta:pe}=fn({validationSchema:_n}),[ye,Ne]=F("title"),[be,Oe]=F("slug"),[v,p]=F("description"),[V,A]=F("price"),[E,_]=F("stock"),[k,J]=F("gender"),{fields:Je}=kt("images"),{fields:Ve,remove:me,push:U}=kt("sizes"),_e=Y([]);Ut(()=>{if(a.value&&!o.value){t.replace({name:"admin-products"});return}}),te(s,()=>{s&&Z({values:s.value})},{deep:!0,immediate:!0});const he=H(async D=>{const K={...D,images:[...D.images,..._e.value]};h(K)}),Se=D=>{const K=Ve.value.map(Fe=>Fe.value);K.includes(D)?me(K.indexOf(D)):U(D)},Ye=D=>Ve.value.map(ae=>ae.value).includes(D),Ue=D=>{const ae=D.target.files;if(!(!ae||ae.length===0))for(const Fe of ae)_e.value.push(Fe)};return te(c,D=>{var K;D&&(r.success("Producto actualizado correctamente"),t.replace({name:"admin-product",params:{productId:(K=O.value)==null?void 0:K.id}}),Z({values:O.value}),_e.value=[])}),te(()=>e.productId,()=>{f()}),{values:S,errors:I,title:ye,titleAttrs:Ne,slug:be,slugAttrs:Oe,description:v,descriptionAttrs:p,price:V,priceAttrs:A,stock:E,stockAttrs:_,gender:k,genderAttrs:J,images:Je,sizes:Ve,meta:pe,isPending:u,imageFiles:_e,allSizes:["XS","S","M","L","XL","XXL"],onSubmit:he,toogleSize:Se,hasSize:Ye,onFileChanged:Ue,temporalImageUrl:D=>URL.createObjectURL(D)}}}),W=e=>(Vr("data-v-97108928"),e=e(),_r(),e),An={class:"bg-white px-5 py-2 rounded"},wn={class:"text-3xl"},En={class:"text-blue-500"},jn=W(()=>y("hr",{class:"my-4"},null,-1)),In={class:"first-col"},Cn={class:"mb-4"},Pn=W(()=>y("label",{for:"title",class:"form-label"},"Título",-1)),Nn={class:"mb-4"},Fn=W(()=>y("label",{for:"slug",class:"form-label"},"Slug",-1)),Tn={class:"mb-4"},kn=W(()=>y("label",{for:"description",class:"form-label"},"Descripción",-1)),Mn={class:"flex flex-row gap-3"},Rn={class:"mb-4"},Un=W(()=>y("label",{for:"price",class:"form-label"},"Precio",-1)),$n={class:"mb-4"},zn=W(()=>y("label",{for:"stock",class:"form-label"},"Inventario",-1)),Bn={class:"mb-4"},Dn=W(()=>y("label",{for:"sizes",class:"form-label"},"Tallas",-1)),Ln={class:"flex"},qn=["onClick"],Wn={class:"first-col"},Kn=W(()=>y("label",{for:"stock",class:"form-label"},"Imágenes",-1)),Hn={class:"flex p-2 overflow-x-auto space-x-8 w-full h-[265px] bg-gray-200 rounded"},Gn=["src","alt"],Xn=["src","alt"],Jn={class:"col-span-2 my-2"},Yn=W(()=>y("label",{for:"image",class:"form-label"},"Subir imagen",-1)),Qn={class:"mb-4"},Zn=W(()=>y("label",{for:"stock",class:"form-label"},"Género",-1)),xn=W(()=>y("option",{value:""},"Seleccione",-1)),es=W(()=>y("option",{value:"kid"},"Niño",-1)),ts=W(()=>y("option",{value:"women"},"Mujer",-1)),rs=W(()=>y("option",{value:"men"},"Hombre",-1)),ns=[xn,es,ts,rs],ss={class:"my-4 text-right"},is=["disabled"],os={class:"grid grid-cols-2"},as={class:"bg-blue-200 p-2"},ls={class:"bg-red-200 p-2"},us={class:"bg-green-200 p-2 col-span-2"};function cs(e,t,r,s,a,o){const f=wt("CustomInput"),h=wt("CustomTextArea");return se(),ne(Be,null,[y("div",An,[y("h1",wn,[br("Producto: "),y("small",En,ue(e.title||"Nuevo producto"),1)]),jn]),y("form",{onSubmit:t[7]||(t[7]=(...u)=>e.onSubmit&&e.onSubmit(...u)),class:"grid grid-cols-1 sm:grid-cols-2 bg-white px-5 gap-5"},[y("div",In,[y("div",Cn,[Pn,ke(f,Ie({modelValue:e.title,"onUpdate:modelValue":t[0]||(t[0]=u=>e.title=u)},e.titleAttrs,{error:e.errors.title}),null,16,["modelValue","error"])]),y("div",Nn,[Fn,ke(f,Ie({modelValue:e.slug,"onUpdate:modelValue":t[1]||(t[1]=u=>e.slug=u)},e.slugAttrs,{error:e.errors.slug}),null,16,["modelValue","error"])]),y("div",Tn,[kn,ke(h,Ie({modelValue:e.description,"onUpdate:modelValue":t[2]||(t[2]=u=>e.description=u)},e.descriptionAttrs,{error:e.errors.description}),null,16,["modelValue","error"])]),y("div",Mn,[y("div",Rn,[Un,ke(f,Ie({modelValue:e.price,"onUpdate:modelValue":t[3]||(t[3]=u=>e.price=u),modelModifiers:{number:!0}},e.priceAttrs,{error:e.errors.price}),null,16,["modelValue","error"])]),y("div",$n,[zn,ke(f,Ie({modelValue:e.stock,"onUpdate:modelValue":t[4]||(t[4]=u=>e.stock=u),modelModifiers:{number:!0}},e.stockAttrs,{error:e.errors.stock}),null,16,["modelValue","error"])])]),y("div",Bn,[Dn,y("div",Ln,[(se(!0),ne(Be,null,lt(e.allSizes,u=>(se(),ne("button",{key:u,type:"button",class:vt(["",["bg-blue-100 p-2 rounded w-14 mr-2 flex-1",{"bg-blue-500 text-white":e.hasSize(u),"bg-blue-100":!e.hasSize(u)}]]),onClick:c=>e.toogleSize(u)},ue(u),11,qn))),128))])])]),y("div",Wn,[Kn,y("div",Hn,[(se(!0),ne(Be,null,lt(e.images,(u,c)=>(se(),ne("div",{key:u.value,class:"flex-shrink-0"},[y("img",{src:u.value,alt:`${c}`,class:"w-[250px] h-[250px]"},null,8,Gn)]))),128)),(se(!0),ne(Be,null,lt(e.imageFiles,(u,c)=>(se(),ne("div",{key:u.name,class:"flex-shrink-0"},[y("img",{src:e.temporalImageUrl(u),alt:`${c}`,class:"w-[250px] h-[250px]"},null,8,Xn)]))),128))]),y("div",Jn,[Yn,y("input",{multiple:"",type:"file",id:"image",class:"form-control",accept:"image/*",onChange:t[5]||(t[5]=(...u)=>e.onFileChanged&&e.onFileChanged(...u))},null,32)]),y("div",Qn,[Zn,He(y("select",Ie({"onUpdate:modelValue":t[6]||(t[6]=u=>e.gender=u)},e.genderAttrs,{class:"form-control"}),ns,16),[[Or,e.gender]]),He(y("span",{class:"text-red-400"},ue(e.errors.gender),513),[[pt,e.errors.gender]])]),y("div",ss,[y("button",{type:"submit",class:"disabled:bg-gray-300 bg-blue-500 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded",disabled:e.isPending}," Guardar ",8,is)])])],32),y("div",os,[y("pre",as,"      "+ue(JSON.stringify(e.values,null,2))+`
    `,1),y("pre",ls,"      "+ue(JSON.stringify(e.errors,null,2))+`
    `,1),y("pre",us,"      "+ue(JSON.stringify(e.meta,null,2))+`
    `,1)])],64)}const ps=mt(Sn,[["render",cs],["__scopeId","data-v-97108928"]]);export{ps as default};
